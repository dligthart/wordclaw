<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="980" viewBox="0 0 1600 980">
  <defs>
    <style>
      .title { font: 700 28px Arial, sans-serif; fill: #0f172a; }
      .label { font: 600 16px Arial, sans-serif; fill: #0f172a; }
      .small { font: 500 13px Arial, sans-serif; fill: #334155; }
      .box { fill: #ffffff; stroke: #1e293b; stroke-width: 2; rx: 10; ry: 10; }
      .group { fill: #f8fafc; stroke: #0f172a; stroke-width: 2; rx: 12; ry: 12; }
      .mid { fill: #eef2ff; stroke: #3730a3; stroke-width: 2; rx: 10; ry: 10; }
      .api { fill: #ecfeff; stroke: #0e7490; stroke-width: 2; rx: 10; ry: 10; }
      .service { fill: #f0fdf4; stroke: #166534; stroke-width: 2; rx: 10; ry: 10; }
      .data { fill: #fffbeb; stroke: #a16207; stroke-width: 2; rx: 10; ry: 10; }
      .db { fill: #fee2e2; stroke: #991b1b; stroke-width: 2; rx: 10; ry: 10; }
      .arrow { stroke: #334155; stroke-width: 2.5; fill: none; marker-end: url(#arrowhead); }
      .dashed { stroke-dasharray: 8 6; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#334155" />
    </marker>
  </defs>

  <text class="title" x="40" y="42">WordClaw System Architecture</text>

  <rect class="group" x="40" y="70" width="1520" height="160" />
  <text class="label" x="64" y="102">Clients</text>

  <rect class="box" x="150" y="120" width="280" height="80" />
  <text class="label" x="250" y="155">Browser / cURL</text>
  <text class="small" x="255" y="178">HTTP requests</text>

  <rect class="box" x="660" y="120" width="280" height="80" />
  <text class="label" x="760" y="155">Agent (LLM)</text>
  <text class="small" x="760" y="178">HTTP or MCP stdio</text>

  <rect class="box" x="1170" y="120" width="280" height="80" />
  <text class="label" x="1265" y="155">CLI Tools</text>
  <text class="small" x="1248" y="178">HTTP automation</text>

  <rect class="group" x="40" y="260" width="1520" height="620" />
  <text class="label" x="64" y="292">WordClaw Server</text>

  <rect class="mid" x="140" y="320" width="1320" height="90" />
  <text class="label" x="170" y="356">Middleware Chain</text>
  <text class="small" x="170" y="384">Request ID  -  Rate Limit  -  Idempotency  -  Auth  -  L402</text>

  <rect class="api" x="170" y="450" width="380" height="170" />
  <text class="label" x="310" y="485">REST API</text>
  <text class="small" x="220" y="515">Fastify routes under /api/*</text>
  <text class="small" x="220" y="540">OpenAPI + Swagger docs</text>

  <rect class="api" x="610" y="450" width="380" height="170" />
  <text class="label" x="735" y="485">GraphQL API</text>
  <text class="small" x="660" y="515">Mercurius schema at /graphql</text>
  <text class="small" x="660" y="540">GraphiQL playground</text>

  <rect class="api" x="1050" y="450" width="380" height="170" />
  <text class="label" x="1180" y="485">MCP Server</text>
  <text class="small" x="1100" y="515">stdio transport for agents</text>
  <text class="small" x="1100" y="540">Tools, resources, prompts</text>

  <rect class="service" x="160" y="650" width="1280" height="100" />
  <text class="label" x="190" y="685">Services Layer</text>
  <text class="small" x="190" y="712">Content Types  -  Content Items  -  Schema Validation  -  API Keys  -  Audit  -  Webhooks  -  Event Bus  -  Payment Provider</text>

  <rect class="data" x="160" y="780" width="1280" height="80" />
  <text class="label" x="190" y="812">Data Layer (Drizzle ORM)</text>
  <text class="small" x="190" y="838">content_types, content_items, content_item_versions, audit_logs, api_keys, webhooks, users</text>

  <rect class="db" x="640" y="900" width="320" height="60" />
  <text class="label" x="700" y="936">PostgreSQL 16</text>

  <line class="arrow" x1="290" y1="200" x2="290" y2="320" />
  <line class="arrow" x1="800" y1="200" x2="800" y2="320" />
  <line class="arrow" x1="1310" y1="200" x2="1310" y2="320" />

  <line class="arrow" x1="360" y1="410" x2="360" y2="450" />
  <line class="arrow" x1="800" y1="410" x2="800" y2="450" />
  <line class="arrow" x1="1240" y1="410" x2="1240" y2="450" />

  <line class="arrow" x1="360" y1="620" x2="360" y2="650" />
  <line class="arrow" x1="800" y1="620" x2="800" y2="650" />
  <line class="arrow" x1="1240" y1="620" x2="1240" y2="650" />

  <line class="arrow" x1="800" y1="750" x2="800" y2="780" />
  <line class="arrow" x1="800" y1="860" x2="800" y2="900" />
</svg>
